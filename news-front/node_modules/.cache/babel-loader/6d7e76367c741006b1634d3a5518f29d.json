{"ast":null,"code":"var _jsxFileName = \"/Users/takatokondou/react-2/wishlist-frontend/src/components/Login.js\";\nimport React, { useReducer } from \"react\";\nimport { withCookies } from \"react-cookie\";\nimport axios from \"axios\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Button from \"@material-ui/core/Button\";\nimport TextField from \"@material-ui/core/TextField\";\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { START_FETCH, FETCH_SUCCESS, ERROR_CATCHED, INPUT_EDIT, TOGGLE_MODE } from \"./actionTypes\";\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main\n  },\n  form: {\n    width: \"100%\",\n    // Fix IE 11 issue.\n    marginTop: theme.spacing(1)\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  },\n  span: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    color: \"teal\"\n  },\n  spanError: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    color: \"fuchsia\",\n    marginTop: 10\n  }\n}));\nconst initialState = {\n  isLoading: false,\n  isLoginView: true,\n  error: \"\",\n  credentialsLog: {\n    username: \"\",\n    password: \"\"\n  },\n  credentialsReg: {\n    email: \"\",\n    password: \"\"\n  }\n};\n\nconst loginReducer = (state, action) => {\n  switch (action.type) {\n    case START_FETCH:\n      {\n        return { ...state,\n          isLoading: true\n        };\n      }\n\n    case FETCH_SUCCESS:\n      {\n        return { ...state,\n          isLoading: false\n        };\n      }\n\n    case ERROR_CATCHED:\n      {\n        return { ...state,\n          error: \"Email or password is not correct!\",\n          isLoading: false\n        };\n      }\n\n    case INPUT_EDIT:\n      {\n        return { ...state,\n          [action.inputName]: action.payload,\n          error: \"\"\n        };\n      }\n\n    case TOGGLE_MODE:\n      {\n        return { ...state,\n          isLoginView: !state.isLoginView\n        };\n      }\n\n    default:\n      return state;\n  }\n};\n\nconst Login = props => {\n  const classes = useStyles();\n  const [state, dispatch] = useReducer(loginReducer, initialState);\n\n  const inputChangedLog = () => event => {\n    const cred = state.credentialsLog;\n    cred[event.target.name] = event.target.value;\n    dispatch({\n      type: INPUT_EDIT,\n      inputName: \"state.credentialLog\",\n      payload: cred\n    });\n  };\n\n  const inputChangedReg = () => event => {\n    const cred = state.credentialsReg;\n    cred[event.target.name] = event.target.value;\n    dispatch({\n      type: INPUT_EDIT,\n      inputName: \"state.credentialReg\",\n      payload: cred\n    });\n  };\n\n  const login = async event => {\n    event.preventDefault();\n\n    if (state.isLoginView) {\n      try {\n        dispatch({\n          type: START_FETCH\n        });\n        const res = await axios.post(\"http://127.0.0.1:8000/authen/\", state.credentialsLog, {\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        });\n        props.cookies.set(\"current-token\", res.data.token);\n        res.data.token ? window.location.href = \"/wishlists\" : window.location.href = \"/\";\n        dispatch({\n          type: FETCH_SUCCESS\n        });\n      } catch {\n        dispatch({\n          type: ERROR_CATCHED\n        });\n      }\n    } else {\n      try {\n        dispatch({\n          type: START_FETCH\n        });\n        await axios.post(\"http://127.0.0.1:8000/api/v1/user/create/\", state.credentialsReg, {\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        });\n        dispatch({\n          type: FETCH_SUCCESS\n        });\n        dispatch({\n          type: TOGGLE_MODE\n        });\n      } catch {\n        dispatch({\n          type: ERROR_CATCHED\n        });\n      }\n    }\n  };\n\n  const toggleView = () => {\n    dispatch({\n      type: TOGGLE_MODE\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Container, {\n    maxWidth: \"xs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: login,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }, state.isLoading && /*#__PURE__*/React.createElement(CircularProgress, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 31\n    }\n  }), /*#__PURE__*/React.createElement(Avatar, {\n    className: classes.avatar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(LockOutlinedIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }\n  }, state.isLoginView ? \"Login\" : \"Register\"), state.isLoginView ? /*#__PURE__*/React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    fullWidth: true,\n    label: \"Email\",\n    name: \"username\",\n    value: state.credentialsLog.username,\n    onChange: inputChangedLog(),\n    autoFocus: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    fullWidth: true,\n    label: \"Email\",\n    name: \"email\",\n    value: state.credentialsReg.email,\n    onChange: inputChangedReg(),\n    autoFocus: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }\n  }), state.isLoginView ? /*#__PURE__*/React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    fullWidth: true,\n    label: \"Password\",\n    name: \"password\",\n    type: \"password\",\n    value: state.credentialsLog.password,\n    onChange: inputChangedLog(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    fullWidth: true,\n    label: \"Password\",\n    name: \"password\",\n    type: \"password\",\n    value: state.credentialsReg.password,\n    onChange: inputChangedReg(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.spanError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 11\n    }\n  }, state.error), state.isLoginView ? !state.credentialsLog.password || !state.credentialsLog.username ? /*#__PURE__*/React.createElement(Button, {\n    className: classes.submit,\n    type: \"submit\",\n    fullWidth: true,\n    disabled: true,\n    variant: \"contained\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 15\n    }\n  }, \"Login\") : /*#__PURE__*/React.createElement(Button, {\n    className: classes.submit,\n    type: \"submit\",\n    fullWidth: true,\n    variant: \"contained\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 15\n    }\n  }, \"Login\") : !state.credentialsReg.password || !state.credentialsReg.email ? /*#__PURE__*/React.createElement(Button, {\n    className: classes.submit,\n    type: \"submit\",\n    fullWidth: true,\n    disabled: true,\n    variant: \"contained\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 13\n    }\n  }, \"Register\") : /*#__PURE__*/React.createElement(Button, {\n    className: classes.submit,\n    type: \"submit\",\n    fullWidth: true,\n    variant: \"contained\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 13\n    }\n  }, \"Register\"), /*#__PURE__*/React.createElement(\"span\", {\n    onClick: () => toggleView(),\n    className: classes.span,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 11\n    }\n  }, state.isLoginView ? \"Create Accout ?\" : \"Back to login ?\"))));\n};\n\nexport default withCookies(Login);","map":{"version":3,"sources":["/Users/takatokondou/react-2/wishlist-frontend/src/components/Login.js"],"names":["React","useReducer","withCookies","axios","Avatar","Button","TextField","LockOutlinedIcon","Typography","makeStyles","Container","CircularProgress","START_FETCH","FETCH_SUCCESS","ERROR_CATCHED","INPUT_EDIT","TOGGLE_MODE","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","span","color","spanError","initialState","isLoading","isLoginView","error","credentialsLog","username","password","credentialsReg","email","loginReducer","state","action","type","inputName","payload","Login","props","classes","dispatch","inputChangedLog","event","cred","target","name","value","inputChangedReg","login","preventDefault","res","post","headers","cookies","set","data","token","window","location","href","toggleView"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;AACA,SAASC,WAAT,QAA4B,cAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,gBAAP,MAA6B,iCAA7B;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,gBAAP,MAA6B,oCAA7B;AACA,SACEC,WADF,EAEEC,aAFF,EAGEC,aAHF,EAIEC,UAJF,EAKEC,WALF,QAMO,eANP;AAQA,MAAMC,SAAS,GAAGR,UAAU,CAAES,KAAD,KAAY;AACvCC,EAAAA,KAAK,EAAE;AACLC,IAAAA,SAAS,EAAEF,KAAK,CAACG,OAAN,CAAc,CAAd,CADN;AAELC,IAAAA,OAAO,EAAE,MAFJ;AAGLC,IAAAA,aAAa,EAAE,QAHV;AAILC,IAAAA,UAAU,EAAE;AAJP,GADgC;AAOvCC,EAAAA,MAAM,EAAE;AACNC,IAAAA,MAAM,EAAER,KAAK,CAACG,OAAN,CAAc,CAAd,CADF;AAENM,IAAAA,eAAe,EAAET,KAAK,CAACU,OAAN,CAAcC,SAAd,CAAwBC;AAFnC,GAP+B;AAWvCC,EAAAA,IAAI,EAAE;AACJC,IAAAA,KAAK,EAAE,MADH;AACW;AACfZ,IAAAA,SAAS,EAAEF,KAAK,CAACG,OAAN,CAAc,CAAd;AAFP,GAXiC;AAevCY,EAAAA,MAAM,EAAE;AACNP,IAAAA,MAAM,EAAER,KAAK,CAACG,OAAN,CAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB;AADF,GAf+B;AAkBvCa,EAAAA,IAAI,EAAE;AACJZ,IAAAA,OAAO,EAAE,MADL;AAEJC,IAAAA,aAAa,EAAE,QAFX;AAGJC,IAAAA,UAAU,EAAE,QAHR;AAIJW,IAAAA,KAAK,EAAE;AAJH,GAlBiC;AAwBvCC,EAAAA,SAAS,EAAE;AACTd,IAAAA,OAAO,EAAE,MADA;AAETC,IAAAA,aAAa,EAAE,QAFN;AAGTC,IAAAA,UAAU,EAAE,QAHH;AAITW,IAAAA,KAAK,EAAE,SAJE;AAKTf,IAAAA,SAAS,EAAE;AALF;AAxB4B,CAAZ,CAAD,CAA5B;AAiCA,MAAMiB,YAAY,GAAG;AACnBC,EAAAA,SAAS,EAAE,KADQ;AAEnBC,EAAAA,WAAW,EAAE,IAFM;AAGnBC,EAAAA,KAAK,EAAE,EAHY;AAInBC,EAAAA,cAAc,EAAE;AACdC,IAAAA,QAAQ,EAAE,EADI;AAEdC,IAAAA,QAAQ,EAAE;AAFI,GAJG;AAQnBC,EAAAA,cAAc,EAAE;AACdC,IAAAA,KAAK,EAAE,EADO;AAEdF,IAAAA,QAAQ,EAAE;AAFI;AARG,CAArB;;AAcA,MAAMG,YAAY,GAAG,CAACC,KAAD,EAAQC,MAAR,KAAmB;AACtC,UAAQA,MAAM,CAACC,IAAf;AACE,SAAKrC,WAAL;AAAkB;AAChB,eAAO,EACL,GAAGmC,KADE;AAELT,UAAAA,SAAS,EAAE;AAFN,SAAP;AAID;;AACD,SAAKzB,aAAL;AAAoB;AAClB,eAAO,EACL,GAAGkC,KADE;AAELT,UAAAA,SAAS,EAAE;AAFN,SAAP;AAID;;AACD,SAAKxB,aAAL;AAAoB;AAClB,eAAO,EACL,GAAGiC,KADE;AAELP,UAAAA,KAAK,EAAE,mCAFF;AAGLF,UAAAA,SAAS,EAAE;AAHN,SAAP;AAKD;;AACD,SAAKvB,UAAL;AAAiB;AACf,eAAO,EACL,GAAGgC,KADE;AAEL,WAACC,MAAM,CAACE,SAAR,GAAoBF,MAAM,CAACG,OAFtB;AAGLX,UAAAA,KAAK,EAAE;AAHF,SAAP;AAKD;;AACD,SAAKxB,WAAL;AAAkB;AAChB,eAAO,EACL,GAAG+B,KADE;AAELR,UAAAA,WAAW,EAAE,CAACQ,KAAK,CAACR;AAFf,SAAP;AAID;;AACD;AACE,aAAOQ,KAAP;AAlCJ;AAoCD,CArCD;;AAuCA,MAAMK,KAAK,GAAIC,KAAD,IAAW;AACvB,QAAMC,OAAO,GAAGrC,SAAS,EAAzB;AACA,QAAM,CAAC8B,KAAD,EAAQQ,QAAR,IAAoBtD,UAAU,CAAC6C,YAAD,EAAeT,YAAf,CAApC;;AAEA,QAAMmB,eAAe,GAAG,MAAOC,KAAD,IAAW;AACvC,UAAMC,IAAI,GAAGX,KAAK,CAACN,cAAnB;AACAiB,IAAAA,IAAI,CAACD,KAAK,CAACE,MAAN,CAAaC,IAAd,CAAJ,GAA0BH,KAAK,CAACE,MAAN,CAAaE,KAAvC;AACAN,IAAAA,QAAQ,CAAC;AACPN,MAAAA,IAAI,EAAElC,UADC;AAEPmC,MAAAA,SAAS,EAAE,qBAFJ;AAGPC,MAAAA,OAAO,EAAEO;AAHF,KAAD,CAAR;AAKD,GARD;;AAUA,QAAMI,eAAe,GAAG,MAAOL,KAAD,IAAW;AACvC,UAAMC,IAAI,GAAGX,KAAK,CAACH,cAAnB;AACAc,IAAAA,IAAI,CAACD,KAAK,CAACE,MAAN,CAAaC,IAAd,CAAJ,GAA0BH,KAAK,CAACE,MAAN,CAAaE,KAAvC;AACAN,IAAAA,QAAQ,CAAC;AACPN,MAAAA,IAAI,EAAElC,UADC;AAEPmC,MAAAA,SAAS,EAAE,qBAFJ;AAGPC,MAAAA,OAAO,EAAEO;AAHF,KAAD,CAAR;AAKD,GARD;;AAUA,QAAMK,KAAK,GAAG,MAAON,KAAP,IAAiB;AAC7BA,IAAAA,KAAK,CAACO,cAAN;;AACA,QAAIjB,KAAK,CAACR,WAAV,EAAuB;AACrB,UAAI;AACFgB,QAAAA,QAAQ,CAAC;AAAEN,UAAAA,IAAI,EAAErC;AAAR,SAAD,CAAR;AACA,cAAMqD,GAAG,GAAG,MAAM9D,KAAK,CAAC+D,IAAN,CAChB,+BADgB,EAEhBnB,KAAK,CAACN,cAFU,EAGhB;AACE0B,UAAAA,OAAO,EAAE;AAAE,4BAAgB;AAAlB;AADX,SAHgB,CAAlB;AAOAd,QAAAA,KAAK,CAACe,OAAN,CAAcC,GAAd,CAAkB,eAAlB,EAAmCJ,GAAG,CAACK,IAAJ,CAASC,KAA5C;AACAN,QAAAA,GAAG,CAACK,IAAJ,CAASC,KAAT,GACKC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,YAD5B,GAEKF,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,GAF5B;AAGAnB,QAAAA,QAAQ,CAAC;AAAEN,UAAAA,IAAI,EAAEpC;AAAR,SAAD,CAAR;AACD,OAdD,CAcE,MAAM;AACN0C,QAAAA,QAAQ,CAAC;AAAEN,UAAAA,IAAI,EAAEnC;AAAR,SAAD,CAAR;AACD;AACF,KAlBD,MAkBO;AACL,UAAI;AACFyC,QAAAA,QAAQ,CAAC;AAAEN,UAAAA,IAAI,EAAErC;AAAR,SAAD,CAAR;AACA,cAAMT,KAAK,CAAC+D,IAAN,CACJ,2CADI,EAEJnB,KAAK,CAACH,cAFF,EAGJ;AACEuB,UAAAA,OAAO,EAAE;AAAE,4BAAgB;AAAlB;AADX,SAHI,CAAN;AAOAZ,QAAAA,QAAQ,CAAC;AAAEN,UAAAA,IAAI,EAAEpC;AAAR,SAAD,CAAR;AACA0C,QAAAA,QAAQ,CAAC;AAAEN,UAAAA,IAAI,EAAEjC;AAAR,SAAD,CAAR;AACD,OAXD,CAWE,MAAM;AACNuC,QAAAA,QAAQ,CAAC;AAAEN,UAAAA,IAAI,EAAEnC;AAAR,SAAD,CAAR;AACD;AACF;AACF,GApCD;;AAsCA,QAAM6D,UAAU,GAAG,MAAM;AACvBpB,IAAAA,QAAQ,CAAC;AAAEN,MAAAA,IAAI,EAAEjC;AAAR,KAAD,CAAR;AACD,GAFD;;AAIA,sBACE,oBAAC,SAAD;AAAW,IAAA,QAAQ,EAAC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAM,IAAA,QAAQ,EAAE+C,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAET,OAAO,CAACnC,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG4B,KAAK,CAACT,SAAN,iBAAmB,oBAAC,gBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADtB,eAEE,oBAAC,MAAD;AAAQ,IAAA,SAAS,EAAEgB,OAAO,CAAC7B,MAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,gBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAFF,eAKE,oBAAC,UAAD;AAAY,IAAA,OAAO,EAAC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGsB,KAAK,CAACR,WAAN,GAAoB,OAApB,GAA8B,UADjC,CALF,EASGQ,KAAK,CAACR,WAAN,gBACC,oBAAC,SAAD;AACE,IAAA,OAAO,EAAC,UADV;AAEE,IAAA,MAAM,EAAC,QAFT;AAGE,IAAA,SAAS,MAHX;AAIE,IAAA,KAAK,EAAC,OAJR;AAKE,IAAA,IAAI,EAAC,UALP;AAME,IAAA,KAAK,EAAEQ,KAAK,CAACN,cAAN,CAAqBC,QAN9B;AAOE,IAAA,QAAQ,EAAEc,eAAe,EAP3B;AAQE,IAAA,SAAS,MARX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,gBAYC,oBAAC,SAAD;AACE,IAAA,OAAO,EAAC,UADV;AAEE,IAAA,MAAM,EAAC,QAFT;AAGE,IAAA,SAAS,MAHX;AAIE,IAAA,KAAK,EAAC,OAJR;AAKE,IAAA,IAAI,EAAC,OALP;AAME,IAAA,KAAK,EAAET,KAAK,CAACH,cAAN,CAAqBC,KAN9B;AAOE,IAAA,QAAQ,EAAEiB,eAAe,EAP3B;AAQE,IAAA,SAAS,MARX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IArBJ,EAiCGf,KAAK,CAACR,WAAN,gBACC,oBAAC,SAAD;AACE,IAAA,OAAO,EAAC,UADV;AAEE,IAAA,MAAM,EAAC,QAFT;AAGE,IAAA,SAAS,MAHX;AAIE,IAAA,KAAK,EAAC,UAJR;AAKE,IAAA,IAAI,EAAC,UALP;AAME,IAAA,IAAI,EAAC,UANP;AAOE,IAAA,KAAK,EAAEQ,KAAK,CAACN,cAAN,CAAqBE,QAP9B;AAQE,IAAA,QAAQ,EAAEa,eAAe,EAR3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,gBAYC,oBAAC,SAAD;AACE,IAAA,OAAO,EAAC,UADV;AAEE,IAAA,MAAM,EAAC,QAFT;AAGE,IAAA,SAAS,MAHX;AAIE,IAAA,KAAK,EAAC,UAJR;AAKE,IAAA,IAAI,EAAC,UALP;AAME,IAAA,IAAI,EAAC,UANP;AAOE,IAAA,KAAK,EAAET,KAAK,CAACH,cAAN,CAAqBD,QAP9B;AAQE,IAAA,QAAQ,EAAEmB,eAAe,EAR3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA7CJ,eAwDE;AAAM,IAAA,SAAS,EAAER,OAAO,CAAClB,SAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAqCW,KAAK,CAACP,KAA3C,CAxDF,EA0DGO,KAAK,CAACR,WAAN,GACC,CAACQ,KAAK,CAACN,cAAN,CAAqBE,QAAtB,IAAkC,CAACI,KAAK,CAACN,cAAN,CAAqBC,QAAxD,gBACE,oBAAC,MAAD;AACE,IAAA,SAAS,EAAEY,OAAO,CAACrB,MADrB;AAEE,IAAA,IAAI,EAAC,QAFP;AAGE,IAAA,SAAS,MAHX;AAIE,IAAA,QAAQ,MAJV;AAKE,IAAA,OAAO,EAAC,WALV;AAME,IAAA,KAAK,EAAC,SANR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,gBAYE,oBAAC,MAAD;AACE,IAAA,SAAS,EAAEqB,OAAO,CAACrB,MADrB;AAEE,IAAA,IAAI,EAAC,QAFP;AAGE,IAAA,SAAS,MAHX;AAIE,IAAA,OAAO,EAAC,WAJV;AAKE,IAAA,KAAK,EAAC,SALR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAbH,GAuBG,CAACc,KAAK,CAACH,cAAN,CAAqBD,QAAtB,IAAkC,CAACI,KAAK,CAACH,cAAN,CAAqBC,KAAxD,gBACF,oBAAC,MAAD;AACE,IAAA,SAAS,EAAES,OAAO,CAACrB,MADrB;AAEE,IAAA,IAAI,EAAC,QAFP;AAGE,IAAA,SAAS,MAHX;AAIE,IAAA,QAAQ,MAJV;AAKE,IAAA,OAAO,EAAC,WALV;AAME,IAAA,KAAK,EAAC,SANR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADE,gBAYF,oBAAC,MAAD;AACE,IAAA,SAAS,EAAEqB,OAAO,CAACrB,MADrB;AAEE,IAAA,IAAI,EAAC,QAFP;AAGE,IAAA,SAAS,MAHX;AAIE,IAAA,OAAO,EAAC,WAJV;AAKE,IAAA,KAAK,EAAC,SALR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBA7FJ,eAwGE;AAAM,IAAA,OAAO,EAAE,MAAM0C,UAAU,EAA/B;AAAmC,IAAA,SAAS,EAAErB,OAAO,CAACpB,IAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGa,KAAK,CAACR,WAAN,GAAoB,iBAApB,GAAwC,iBAD3C,CAxGF,CADF,CADF,CADF;AAkHD,CApLD;;AAsLA,eAAerC,WAAW,CAACkD,KAAD,CAA1B","sourcesContent":["import React, { useReducer } from \"react\";\nimport { withCookies } from \"react-cookie\";\nimport axios from \"axios\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Button from \"@material-ui/core/Button\";\nimport TextField from \"@material-ui/core/TextField\";\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport {\n  START_FETCH,\n  FETCH_SUCCESS,\n  ERROR_CATCHED,\n  INPUT_EDIT,\n  TOGGLE_MODE,\n} from \"./actionTypes\";\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main,\n  },\n  form: {\n    width: \"100%\", // Fix IE 11 issue.\n    marginTop: theme.spacing(1),\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2),\n  },\n  span: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    color: \"teal\",\n  },\n  spanError: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    color: \"fuchsia\",\n    marginTop: 10,\n  },\n}));\n\nconst initialState = {\n  isLoading: false,\n  isLoginView: true,\n  error: \"\",\n  credentialsLog: {\n    username: \"\",\n    password: \"\",\n  },\n  credentialsReg: {\n    email: \"\",\n    password: \"\",\n  },\n};\n\nconst loginReducer = (state, action) => {\n  switch (action.type) {\n    case START_FETCH: {\n      return {\n        ...state,\n        isLoading: true,\n      };\n    }\n    case FETCH_SUCCESS: {\n      return {\n        ...state,\n        isLoading: false,\n      };\n    }\n    case ERROR_CATCHED: {\n      return {\n        ...state,\n        error: \"Email or password is not correct!\",\n        isLoading: false,\n      };\n    }\n    case INPUT_EDIT: {\n      return {\n        ...state,\n        [action.inputName]: action.payload,\n        error: \"\",\n      };\n    }\n    case TOGGLE_MODE: {\n      return {\n        ...state,\n        isLoginView: !state.isLoginView,\n      };\n    }\n    default:\n      return state;\n  }\n};\n\nconst Login = (props) => {\n  const classes = useStyles();\n  const [state, dispatch] = useReducer(loginReducer, initialState);\n\n  const inputChangedLog = () => (event) => {\n    const cred = state.credentialsLog;\n    cred[event.target.name] = event.target.value;\n    dispatch({\n      type: INPUT_EDIT,\n      inputName: \"state.credentialLog\",\n      payload: cred,\n    });\n  };\n\n  const inputChangedReg = () => (event) => {\n    const cred = state.credentialsReg;\n    cred[event.target.name] = event.target.value;\n    dispatch({\n      type: INPUT_EDIT,\n      inputName: \"state.credentialReg\",\n      payload: cred,\n    });\n  };\n\n  const login = async (event) => {\n    event.preventDefault();\n    if (state.isLoginView) {\n      try {\n        dispatch({ type: START_FETCH });\n        const res = await axios.post(\n          \"http://127.0.0.1:8000/authen/\",\n          state.credentialsLog,\n          {\n            headers: { \"Content-Type\": \"application/json\" },\n          }\n        );\n        props.cookies.set(\"current-token\", res.data.token);\n        res.data.token\n          ? (window.location.href = \"/wishlists\")\n          : (window.location.href = \"/\");\n        dispatch({ type: FETCH_SUCCESS });\n      } catch {\n        dispatch({ type: ERROR_CATCHED });\n      }\n    } else {\n      try {\n        dispatch({ type: START_FETCH });\n        await axios.post(\n          \"http://127.0.0.1:8000/api/v1/user/create/\",\n          state.credentialsReg,\n          {\n            headers: { \"Content-Type\": \"application/json\" },\n          }\n        );\n        dispatch({ type: FETCH_SUCCESS });\n        dispatch({ type: TOGGLE_MODE });\n      } catch {\n        dispatch({ type: ERROR_CATCHED });\n      }\n    }\n  };\n\n  const toggleView = () => {\n    dispatch({ type: TOGGLE_MODE });\n  };\n\n  return (\n    <Container maxWidth=\"xs\">\n      <form onSubmit={login}>\n        <div className={classes.paper}>\n          {state.isLoading && <CircularProgress />}\n          <Avatar className={classes.avatar}>\n            <LockOutlinedIcon />\n          </Avatar>\n          <Typography variant=\"h5\">\n            {state.isLoginView ? \"Login\" : \"Register\"}\n          </Typography>\n\n          {state.isLoginView ? (\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              fullWidth\n              label=\"Email\"\n              name=\"username\"\n              value={state.credentialsLog.username}\n              onChange={inputChangedLog()}\n              autoFocus\n            />\n          ) : (\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              fullWidth\n              label=\"Email\"\n              name=\"email\"\n              value={state.credentialsReg.email}\n              onChange={inputChangedReg()}\n              autoFocus\n            />\n          )}\n\n          {state.isLoginView ? (\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              fullWidth\n              label=\"Password\"\n              name=\"password\"\n              type=\"password\"\n              value={state.credentialsLog.password}\n              onChange={inputChangedLog()}\n            />\n          ) : (\n            <TextField\n              variant=\"outlined\"\n              margin=\"normal\"\n              fullWidth\n              label=\"Password\"\n              name=\"password\"\n              type=\"password\"\n              value={state.credentialsReg.password}\n              onChange={inputChangedReg()}\n            />\n          )}\n          <span className={classes.spanError}>{state.error}</span>\n\n          {state.isLoginView ? (\n            !state.credentialsLog.password || !state.credentialsLog.username ? (\n              <Button\n                className={classes.submit}\n                type=\"submit\"\n                fullWidth\n                disabled\n                variant=\"contained\"\n                color=\"primary\"\n              >\n                Login\n              </Button>\n            ) : (\n              <Button\n                className={classes.submit}\n                type=\"submit\"\n                fullWidth\n                variant=\"contained\"\n                color=\"primary\"\n              >\n                Login\n              </Button>\n            )\n          ) : !state.credentialsReg.password || !state.credentialsReg.email ? (\n            <Button\n              className={classes.submit}\n              type=\"submit\"\n              fullWidth\n              disabled\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              Register\n            </Button>\n          ) : (\n            <Button\n              className={classes.submit}\n              type=\"submit\"\n              fullWidth\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              Register\n            </Button>\n          )}\n\n          <span onClick={() => toggleView()} className={classes.span}>\n            {state.isLoginView ? \"Create Accout ?\" : \"Back to login ?\"}\n          </span>\n        </div>\n      </form>\n    </Container>\n  );\n};\n\nexport default withCookies(Login);\n"]},"metadata":{},"sourceType":"module"}